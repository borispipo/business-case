
<app-main class="main">
  <div class="main-content container">
    <h2 class="m-2 text-center w100 app-title">
        Web Tracker
    </h2>
    <div class="main-header">
        <div class="flex">
            <input class="track-package-input" placeholder="Enter Package ID" [value]="packageId" (input)="onSearchChange($event.target.value)"/>
            <button mat-flat-button class="ml-2" [disabled] = "isLoading" color="primary" (click)="trackPackage()">Track</button>
        </div>
        <div class="mt-1" *ngIf="isLoading">
          <mat-progress-bar  mode="indeterminate"></mat-progress-bar>
        </div>
        <div *ngIf = "trackPackageError && false" class="w100 text-center pt-2 pb-2 text-error">
            {{trackPackageError}}
        </div>
    </div>
    <div class="w100 flex justify-space-between tracker-content-container">
      <div class="package-delivery-container">
          <div class="p-1 mt-2">
            <div class="title">Package Details</div>
            <mat-divider/>
            <div *ngIf = "package" class="package-details">
              <list-detail label="Description" value={{package.description}}></list-detail>
              <list-detail label="From Name" value = {{package.from_name}}/>
              <list-detail label="To Name" value = {{package.to_name}}/>
              <list-detail label="From addres" value = {{package.from_address}}/>
              <list-detail label="To Address" value = {{package.to_address}}/>
              <list-detail label="Weight" value = {{package.weight}}/>
              <list-detail label="Height" value = {{package.height}}/>
              <list-detail label="Depth" value = {{package.depth}}/>
            </div>
            <div *ngIf="!package" class="p-1">
              <p class="not-found-text">Not package Found with Id [{{packageId || ''}}] </p>
            </div>
          </div>
          <div class="p-1 mt-5">
            <div class="w100">
              <mat-divider/>
              <div class="title">Delivery Details</div>
            </div>
            <div *ngIf="!delivery" class="p-1 not-found-text">
              <p class="not-found-text">Not active deliveries associated with the package Id [{{packageId || ''}}] </p>
            </div>
            <div *ngIf = "delivery" class="active-delivery-details">
              <list-detail label="ID" value={{delivery.delivery_id}}></list-detail>
              <list-detail label="Address" value={{delivery.address}}></list-detail>
              <list-detail label="Status" value = {{delivery.status}}/>
              <list-detail label="Pickup time" value={{dateToDefaultFormat(delivery.pickup_time)}}></list-detail>
              <list-detail label="Start Time" value = {{dateToDefaultFormat(delivery.start_time)}}/>
              <list-detail label="End Time" value = {{dateToDefaultFormat(delivery.end_time)}}/>
              <app-socket/>
            </div>
          </div>
      </div>
      <div class="map-container">
        <app-map  [locationFrom]="package?.from_location" [locationTo]="package?.to_location" [location]="delivery?.location">
        </app-map>
      
      </div>
    </div>
  </div>
</app-main>
